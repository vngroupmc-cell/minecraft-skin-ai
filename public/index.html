<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>AI Minecraft Skin</title>

<style>
:root{
  --card:#0b1f4a;
  --bg:#040b22;
  --btn:#7ddcff;
  --btn2:#6bbcd6;
  --text:#ffffff;
}

*{box-sizing:border-box;font-family:sans-serif}

body{
  margin:0;
  min-height:100vh;
  background: radial-gradient(circle at top, #1b3b8f, var(--bg));
  display:flex;
  justify-content:center;
  align-items:center;
  color:var(--text);
}

.card{
  width:92%;
  max-width:420px;
  background:linear-gradient(180deg,#0e2a6d,#08183d);
  border-radius:26px;
  padding:28px 22px;
  box-shadow:0 20px 60px rgba(0,0,0,.5);
}

h1{ margin:0 0 6px; font-size:24px; }
.subtitle{ opacity:.85; margin-bottom:18px; }

input{
  width:100%;
  padding:16px 18px;
  border-radius:999px;
  border:none;
  font-size:15px;
  margin-bottom:14px;
  outline:none;
}
input:focus{ box-shadow:0 0 0 3px rgba(125,220,255,.5); }

.btn{
  width:100%;
  padding:16px;
  border-radius:999px;
  border:none;
  background:linear-gradient(135deg,var(--btn),#9be8ff);
  font-size:16px;
  font-weight:bold;
  cursor:pointer;
  transition:.25s;
  margin-top:10px;
}
.btn.small{ background:var(--btn2); font-weight:500; }
.btn:hover{ transform:translateY(-2px); box-shadow:0 10px 25px rgba(125,220,255,.45); }
.btn:disabled{ background:#555; cursor:not-allowed; transform:none; box-shadow:none; }

.divider{
  height:1px;
  background:rgba(255,255,255,.15);
  margin:18px 0;
}

/* loading */
.loading{
  display:none;
  text-align:center;
  margin-top:10px;
}
.spinner{
  width:36px;
  height:36px;
  border:4px solid rgba(255,255,255,.2);
  border-top:4px solid #fff;
  border-radius:50%;
  animation:spin 1s linear infinite;
  margin:10px auto;
}
@keyframes spin{to{transform:rotate(360deg)}}

/* modal */
.modal{
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.8);
  display:none;
  justify-content:center;
  align-items:center;
  z-index:10;
  backdrop-filter: blur(4px);
}
.modal-content{
  background:#08183d;
  border-radius:20px;
  padding:20px;
  width:85%;
  max-width:320px;
  text-align:center;
  box-shadow: 0 10px 30px rgba(0,0,0,0.5);
}
.modal img{
  width:100%;
  border-radius:14px;
  margin-bottom:10px;
  border: 2px solid rgba(255,255,255,0.1);
}
.close{ opacity:.8; cursor:pointer; padding:10px; background:rgba(255,255,255,0.1); border-radius:10px; }
</style>
</head>

<body>

<div class="card">
  <h1>üåô AI Minecraft Skin</h1>
  <div class="subtitle">‡∏û‡∏¥‡∏°‡∏û‡πå‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞‡∏™‡∏Å‡∏¥‡∏ô (‡∏†‡∏≤‡∏©‡∏≤‡πÑ‡∏ó‡∏¢)</div>

  <input id="prompt" placeholder="‡πÄ‡∏ä‡πà‡∏ô: ‡∏ú‡∏π‡πâ‡∏ä‡∏≤‡∏¢ ‡∏ú‡∏°‡∏î‡∏≥ ‡πÄ‡∏™‡∏∑‡πâ‡∏≠‡∏Æ‡∏π‡πâ‡∏î‡∏™‡∏µ‡∏ü‡πâ‡∏≤"/>
  <input id="name" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏Å‡∏¥‡∏ô (‡πÄ‡∏ä‡πà‡∏ô: MySkin)"/>

  <button class="btn" id="genBtn" onclick="generateSkin()">‚ú® ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏™‡∏Å‡∏¥‡∏ô AI</button>

  <div class="loading" id="loading">
    <div class="spinner"></div>
    <span>‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡πÄ‡∏ã‡∏¥‡∏£‡πå‡∏ü‡πÄ‡∏ß‡∏≠‡∏£‡πå...</span>
  </div>

  <div class="divider"></div>

  <button class="btn small" onclick="openModal('skin')">üëÅ ‡∏î‡∏π‡∏™‡∏Å‡∏¥‡∏ô</button>
  <button class="btn small" onclick="openModal('fanart')">üé® ‡∏î‡∏π‡πÅ‡∏ü‡∏ô‡∏≠‡∏≤‡∏£‡πå‡∏ï</button>

  <div class="divider"></div>

  <button class="btn small" onclick="downloadImage('skin')">üèÖ ‡πÇ‡∏´‡∏•‡∏î‡∏™‡∏Å‡∏¥‡∏ô</button>
  <button class="btn small" onclick="downloadImage('fanart')">üèÖ ‡πÇ‡∏´‡∏•‡∏î‡πÅ‡∏ü‡∏ô‡∏≠‡∏≤‡∏£‡πå‡∏ï</button>
</div>

<div class="modal" id="modal">
  <div class="modal-content">
    <img id="modalImg" src="" />
    <div class="close" onclick="closeModal()">‡∏õ‡∏¥‡∏î‡∏´‡∏ô‡πâ‡∏≤‡∏ï‡πà‡∏≤‡∏á</div>
  </div>
</div>

<script>
let skinImg = "";
let fanartImg = "";

async function generateSkin(){
  const prompt = document.getElementById("prompt").value;
  const name = document.getElementById("name").value;
  const loading = document.getElementById("loading");
  const btn = document.getElementById("genBtn");

  if(!prompt){
    alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞‡∏™‡∏Å‡∏¥‡∏ô");
    return;
  }

  // ‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÇ‡∏´‡∏•‡∏î
  loading.style.display = "block";
  btn.disabled = true;
  btn.innerText = "‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á...";

  try{
    const res = await fetch("https://minecraft-skin-ai.onrender.com/api/generate",{
      method:"POST",
      headers:{
        "Content-Type":"application/json"
      },
      body:JSON.stringify({
        prompt: prompt,
        name: name || "minecraft_skin"
      })
    });

    if(!res.ok) throw new Error("Server Error");

    const data = await res.json();

    // ‡∏™‡∏°‡∏°‡∏ï‡∏¥ Backend ‡∏™‡πà‡∏á‡∏Å‡∏•‡∏±‡∏ö‡∏°‡∏≤‡πÄ‡∏õ‡πá‡∏ô { skinUrl: "...", fanartUrl: "..." }
    // ‡∏´‡∏≤‡∏Å backend ‡∏™‡πà‡∏á key ‡∏≠‡∏∑‡πà‡∏ô‡∏°‡∏≤ ‡πÉ‡∏´‡πâ‡πÅ‡∏Å‡πâ‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ‡∏Ñ‡∏£‡∏±‡∏ö
    skinImg = data.skinUrl;
    fanartImg = data.fanartUrl;

    alert("‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏™‡∏Å‡∏¥‡∏ô‡πÄ‡∏™‡∏£‡πá‡∏à‡πÅ‡∏•‡πâ‡∏ß! ‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏°‡∏î‡∏π‡∏£‡∏π‡∏õ‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢");

  } catch(err){
    alert("‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡πÄ‡∏ã‡∏¥‡∏£‡πå‡∏ü‡πÄ‡∏ß‡∏≠‡∏£‡πå");
    console.error(err);
  } finally {
    // ‡∏à‡∏ö‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô ‡πÑ‡∏°‡πà‡∏ß‡πà‡∏≤‡∏à‡∏∞‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡∏´‡∏£‡∏∑‡∏≠‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß
    loading.style.display = "none";
    btn.disabled = false;
    btn.innerText = "‚ú® ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏™‡∏Å‡∏¥‡∏ô AI";
  }
}

function openModal(type){
  // ‡πÄ‡∏ä‡πá‡∏Ñ‡∏ß‡πà‡∏≤‡∏°‡∏µ‡∏£‡∏π‡∏õ‡∏´‡∏£‡∏∑‡∏≠‡∏¢‡∏±‡∏á
  if(type === 'skin' && !skinImg){ alert("‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏™‡∏Å‡∏¥‡∏ô‡∏Ñ‡∏£‡∏±‡∏ö ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Å‡πà‡∏≠‡∏ô"); return; }
  if(type === 'fanart' && !fanartImg){ alert("‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÅ‡∏ü‡∏ô‡∏≠‡∏≤‡∏£‡πå‡∏ï‡∏Ñ‡∏£‡∏±‡∏ö"); return; }

  document.getElementById("modal").style.display="flex";
  document.getElementById("modalImg").src =
    type === "skin" ? skinImg : fanartImg;
}

function closeModal(){
  document.getElementById("modal").style.display="none";
}

// ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î (‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏õ‡∏∏‡πà‡∏°‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ)
async function downloadImage(type) {
  const url = (type === 'skin') ? skinImg : fanartImg;
  
  if (!url) {
    alert("‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡πÉ‡∏´‡πâ‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î");
    return;
  }

  try {
    const fileName = document.getElementById("name").value || 'skin';
    
    // ‡∏î‡∏∂‡∏á‡∏£‡∏π‡∏õ‡∏°‡∏≤‡πÄ‡∏õ‡πá‡∏ô Blob ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö‡πÇ‡∏´‡∏•‡∏î
    const response = await fetch(url);
    const blob = await response.blob();
    const link = document.createElement("a");
    link.href = URL.createObjectURL(blob);
    link.download = `${fileName}_${type}.png`;
    document.body.appendChild(link);
    link.click();
    document.body.removeChild(link);
  } catch (error) {
    console.error(error);
    // ‡∏Å‡∏£‡∏ì‡∏µ‡∏ï‡∏¥‡∏î CORS ‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡∏¥‡∏î‡πÅ‡∏ó‡πá‡∏ö‡πÉ‡∏´‡∏°‡πà‡πÅ‡∏ó‡∏ô
    window.open(url, '_blank');
  }
}

// ‡∏õ‡∏¥‡∏î Modal ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏Ñ‡∏•‡∏¥‡∏Å‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á
window.onclick = function(e){
  if(e.target == document.getElementById("modal")) closeModal();
}
</script>

</body>
</html>
